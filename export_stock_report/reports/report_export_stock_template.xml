<odoo>
  <template id="report_export_stock">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="doc">
        <div class="page">

          <!-- Judul Report -->
          <h2 style="text-align:center;">LAPORAN EXPORT STOCK</h2>
          <p>
            Periode:
            <span t-esc="doc.start_date"/> s/d <span t-esc="doc.end_date"/>
          </p>

          <!-- Tabel utama (customer / produk) -->
          <!-- ... tabel detail per customer di sini ... -->

          <!-- Tabel baru: Grand Total per Warehouse -->
          <h3 style="margin-top:20px;">TOTAL KESELURUHAN PER WAREHOUSE</h3>
          <table class="table table-bordered" style="width:100%; border-collapse: collapse; text-align:center;">
            <thead>
              <tr>
                <th>Warehouse</th>
                <th>Total Count (BOX)</th>
                <t t-foreach="uoms" t-as="uom">
                  <th><t t-esc="uom['name']"/></th>
                </t>
              </tr>
            </thead>
            <tbody>
              <!-- Baris per warehouse -->
              <t t-foreach="warehouses" t-as="wh">
                <tr>
                  <td><t t-esc="wh"/></td>
                  <td>
                    <t t-esc="int(warehouse_uom_totals[wh].get('total_count',0))"/>
                  </td>
                  <t t-foreach="uoms" t-as="uom">
                    <td>
                      <t t-esc="'%.0f' % warehouse_uom_totals[wh].get(uom['id'],0)"/>
                    </td>
                  </t>
                </tr>
              </t>

              <!-- Grand total -->
              <tr style="font-weight:bold; background:#f0f0f0;">
                <td>GRAND TOTAL</td>
                <td>
                  <t t-esc="int(grand_uom_totals.get('total_count',0))"/>
                </td>
                <t t-foreach="uoms" t-as="uom">
                  <td>
                    <t t-esc="'%.0f' % grand_uom_totals.get(uom['id'],0)"/>
                  </td>
                </t>
              </tr>
            </tbody>
          </table>

        </div>
      </t>
    </t>
  </template>
</odoo>
