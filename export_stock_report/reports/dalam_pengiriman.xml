<odoo>
  <template id="stock_report_pengiriman">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="wizard">

        <div class="page">
          <h2 style="text-align:center; font-weight:bold;">
            TOTAL STOK BOX EXPORT DALAM PERJALANAN
          </h2>
          <h3 style="text-align:center;">
            per tanggal <t t-esc="time.strftime('%d-%m-%Y', time.strptime(str(wizard.end_date), '%Y-%m-%d %H:%M:%S'))"/>
          </h3>

          <t t-foreach="result.items()" t-as="wh">
            <t t-set="warehouse" t-value="wh[0]"/>
            <t t-set="data_warehouse" t-value="wh[1]"/>

            <h4 style="margin-top:25px; text-transform:uppercase;">
              WAREHOUSE <t t-esc="warehouse"/>
            </h4>

            <!-- ====================== TABLE DETAIL ====================== -->
            <table class="table table-sm table-bordered" style="width:100%; border-collapse: collapse; font-size:12px;">
              <thead style="background-color:#d9d9d9; text-align:center;">
                <tr>
                  <th style="width:25px;">No</th>
                  <th>No.Cont</th>
                  <th>ETD</th>
                  <th>ETA</th>
                  <th>Design</th>
                  <th>Grade</th>
                  <th>Qty</th>
                  <th>Tujuan</th>
                  <th>Ket</th>
                </tr>
              </thead>
              <tbody>
                <t t-set="no" t-value="1"/>
                <t t-foreach="data_warehouse.items()" t-as="design_item">
                  <t t-set="design" t-value="design_item[0]"/>
                  <t t-set="grade_dict" t-value="design_item[1]"/>
                  <t t-foreach="grade_dict.items()" t-as="grade_item">
                    <t t-set="grade" t-value="grade_item[0]"/>
                    <t t-set="lines" t-value="grade_item[1]"/>

                    <t t-foreach="lines" t-as="line">
                      <tr>
                        <td style="text-align:center;"><t t-esc="no"/></td>
                        <td><t t-esc="line['origin']"/></td>
                        <td style="text-align:center;"></td>
                        <td style="text-align:center;"></td>
                        <td><t t-esc="line['product']"/></td>
                        <td><t t-esc="line['grade']"/></td>
                        <td style="text-align:right;"><t t-esc="'{:,.0f}'.format(line['qty'])"/></td>
                        <td><t t-esc="line['destination']"/></td>
                        <td><t t-esc="line['ket']"/></td>
                      </tr>
                      <t t-set="no" t-value="no + 1"/>
                    </t>
                  </t>
                </t>
                <tr style="font-weight:bold; background-color:#f0f0f0;">
                  <td colspan="6" style="text-align:center;">TOTAL</td>
                  <td colspan="3"></td>
                </tr>
              </tbody>
            </table>

            <!-- ====================== TABLE TOTAL PER DESIGN ====================== -->
            <div style="margin-top:20px;">
              <h5 style="font-weight:bold;">TOTAL / DESIGN</h5>
              <table class="table table-sm table-bordered" style="width:60%; border-collapse: collapse; font-size:12px;">
                <thead style="background-color:#d9d9d9; text-align:center;">
                  <tr>
                    <th>DESGN/GRD</th>
                    <th>BOX</th>
                    <th>CONT</th>
                  </tr>
                </thead>
                <tbody>
                  <t t-foreach="total_per_design[warehouse]" t-as="tline">
                    <tr>
                      <td><t t-esc="tline['design']"/></td>
                      <td style="text-align:right;"><t t-esc="'{:,.0f}'.format(tline['total_box'])"/></td>
                      <td style="text-align:right;"><t t-esc="'{:.2f}'.format(tline['total_cont'])"/></td>
                    </tr>
                  </t>
                  <tr style="font-weight:bold; background-color:#f0f0f0;">
                    <td style="text-align:center;">TOTAL</td>
                    <td colspan="2"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </t>
        </div>

      </t>
    </t>
  </template>
</odoo>
